# ファイルシステムの実装

### 注意書き

 * 筆者の自習、教育的な用途を目的とした文章です
 * カーネルのバージョンは 2.6.32 ベースで記述しています
 * バニラカーネルのソースを掲載したページへのリンクを貼っているが、CentOSのカーネルはパッチが当たっているので、内容が全然一致しない場合があります
 * backing store を RAM にしたファイルシステムを念頭にしていて、ブロックデバイスのことは考えていません
   * ブロックデバイスベースのファイルシステムは複雑ぽいので、tmpfs と VirtualBox の vboxsf [ソース](https://www.virtualbox.org/wiki/Downloads)を参考に読み解いていく
      * vboxfs のソースは src/VBox/Additions/linux/sharedfolders 以下
   * 追記: tmpfs よりも ramfs の方が素朴な実装なので、最初に読むなら ramfs。ただし、カーネルのAPIをある程度知らないと逆に手がかかりがなさ過ぎるかも
   * 追記: fs/libfs.c の関数群も実装のヒントになる
 * 単語の定義を明確
   * _割り当て_ と書いた場合は、カーネルのメモリ管理APIで実メモリを確保していることを指すようにします (破棄はその逆)
   * _初期化_ と書いた場合は、メモリ割り当てされた構造体の未初期化のフィールドを初期化することを指すようにします
   * _実装_ と書いた場合は、モジュール作成者が任意のコードを書く必要があることを指すようにします
 * [https://github.com/hiboma/nukofs](https://github.com/hiboma/nukofs) に学習用の実装を残しています

